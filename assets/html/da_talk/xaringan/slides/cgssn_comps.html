<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>CGSSN Comps</title>
    <meta charset="utf-8" />
    <meta name="author" content="Max Chumley   —   Mechanical Engineering  —  Michigan State University   —" />
    <meta name="date" content="2024-03-23" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="../../css/msu.css" type="text/css" />
    <link rel="stylesheet" href="../../css/gallery.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url(https://upload.wikimedia.org/wikipedia/en/5/53/Michigan_State_University_seal.svg)
background-position: 10% 95%
background-size: 12%
class: inverse left top

# Persistent Homology of Coarse Grained State Space Networks

### **Max Chumley** &lt;br&gt; &amp;mdash; &lt;br&gt; Mechanical Engineering&lt;br&gt;&lt;br&gt;Computational Mathematics&lt;br&gt;Science and Engineering&lt;br&gt; &amp;mdash;&lt;br&gt;Date: 3-23-24

&lt;!-- ------------------------------------------------------- --&gt;
&lt;!-- DO NOT REMOVE --&gt;

&lt;!-- ------------------------------------------------------- --&gt;


&lt;!-- SET TITLE IMAGES HERE -- NOTE: :img takes 3 arguments: (width, left, top) to position the graphic.--&gt;
![:img 60%, 37.5%, 25%](../Figs/white_block.png)
![:img 55%, 41%, 37%](../Figs/cg_pipeline/cg_title.gif)

???
Hello, in this talk I will be presenting my work on persistent homology of coarse grained state space networks for dynamic state identification.

---
# Acknowledgements 

![:img 80%, 10%, 30%](../Figs/cg_pipeline/cg_people.png)

???
I would like to start by thanking the air force office of  scientific research for funding this work. I would also like to thank my collaborators shown here. 

---

# Pipeline


![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline1.png)

???
When analyzing a timeseries, many times it is easy for a human to distinguish a periodic signal from a chaotic one. However, characterizing these states automatically can be computationally expensive. A common approach for improving the efficiency of this process is to represent the timeseries as a network.  

In this pipeline there are three methods for doing this, using a takens embedding to reconstruct the attractor, sequences of ordinal patterns and coarse graining of the state space which I will be discussing today. These approaches result in a network representation of the signal. 

My goal was to study the topology of the coarse grained state space network for state identification and I did this by obtaining a distance matrix for the network and then computed persistent homology of the network to get the persistence diagram. The persistent diagrams were then used for determining the dynamic state of the signal.

--
![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline2.png)
--
![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline3.png)
--
![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline4.png)
--
![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline5.png)



---

# Motivation - Ordinal Partition Networks (OPN)

![:img 70%, 15%, 30%](../Figs/opn_basic_sliding.gif)

???
I will start by showing the ordinal partition network to motivate the need for the coarse grained state space network. The ordinal partition network or OPN for a timeseries signal is generated by setting a permutation dimension and delay to study the sequence of permutations as the signal is traversed. 

In this case the permutation dimension is 3 so there are 3 factorial or 6 possible states in our permutation sequence. Each state makes up a vertex in the network and transitions between those permutations make up an edge between two vertices. 

---
count: false
# Motivation - Undesired Transitions

![:img 60%, 20%, 22%](../Figs/undesired_transitions.png)

???
Ordinal partition networks can be susceptible to noise. If the signal is close to the hyper diagonal at any point in the trajectory and noise is added to the system there can be undesired state transitions in the permutation sequence that drastically alter the resulting network. 

---
# Coarse-grained State Space Networks (CGSSN)

![:img 90%, 5%, 30%](../Figs/CGSSN_2d_example_cycle.gif)

???
The coarse-grained state space or CGSSN method mitigates this issue by binning the state space into hypercubes and taking each hypercube to be a state in the network. 

Here is the coarse grained state space network generation for a simple sine wave signal. 
  
---

# Network Formulation

![:img 80%, 10%, 20%](../Figs/network/network_1.png)

???
Mathematically speaking, to formulate these networks I will start with the timeseries signal and choose a permutation delay and dimension using automatic methods from attractor reconstruction. 

For ordinal partition networks the relative ordering of the permutation nodes are studied to determine the state. In this case the ordering is 1 2 0 so this corresponds to group pi_5 and the state identifier s_i is set to be 5. 

For CGSSNs, with the same permutation group, the outputs of the signal at these points are binned. The heights of the permutation nodes are mapped into these bins 

to determine the state vector 

and the state identifier is then computed by digitizing the state vector. In this case we are in state 172.

--
![:img 80%, 10%, 20%](../Figs/network/network_2.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_3.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_4.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_5.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_6.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_7.png)
--
![:img 80%, 10%, 20%](../Figs/network/network_8.png)

&lt;!-- the multiscale permutation entropy method and dimension using the false nearest neighbors method to slide across the signal. --&gt;

 

---

# CGSSN with Noise 
- Periodic Rossler System

 `\(\frac{dx}{dt}  = -y -z, \\ \frac{dy}{dt}  = x + ay, \\ \frac{dz}{dt}  = b + z(x-c)\)`

- `\(a=0.1\)`
- `\(b=0.2\)`
- `\(c=14\)`

- Timeseries: `\(z(t)\)`

???
Here is an example comparing the ordinal partition network to the coarse grained state space network with noise in the system. Using the periodic rossler system the third state is used. 

The OPN results show that the network topology contains many uncessesary transitions from the noise. Whereas the CGSSN is mostly unchanged when noise is added showing that CGSSNs can be more robust to noise. 

In other words it is more difficult to obtain state transitions that drastically alter the topology of the network in the presence of noise. 

--

![:img 65%, 35%, 20%](../Figs/rossler_5.png)
--
![:img 65%, 35%, 20%](../Figs/rossler_6.png)

---
# Distance Matrix and Persistence

![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline5.png)

???
Now we will move into the next steps in the pipeline where the distance matrix and persistence diagram are computed. 

---
# Persistent Homology - Network

![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd1.png)

???
In order to quantify the network topology, a tool called persistent homology was used to measure loops and connected components of the network. If I start with the weighted network here, we see that there are two loops in the network and persistence allows for quantifying the importance or size of the loops automatically. 

It works by defining a notion of distance on the network. One way of doing this is to use the shortest path distance between two vertices as shown here where the cost function C(P) is minimized to determine the path that minimizes the sum of the weights between two vertices. 

Doing this for all pairs of vertices in the network gives its corresponding distance matrix allowing for a simplicial complex or generalized graph to be induced on the network. Computing the homology at different points in the process allows for tracking the birth and death of loops and connected components. 

For example, we start with all of the vertices in the network a connectivity parameter is varied to induce the simplicial complex. The connectivity parameter is zero here and when it reaches the value of the distance between two vertices, an edge or 1-simplex is added between them. At this point we see the two loops are born. If the distance condition is true for any 3 vertices a 2-simplex or face is added. 

As I increase the connectivity parameter the loops fill in. The birth and death of the loops is tracked in the 1D persistence diagram by plotting the value of the connectivity parameter at birth as the x coordinate and death as y coordinate.

With this idea, the prominent structures of the network show up far from the diagonal. A cycle network would have a single loop and a tangled network would have many loops which could correspond to periodic and chaotic coarse grained state space networks allowing for the persistence diagrams to be used to perform dynamic state detection. 

--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd2.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd3.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd4.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd5.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd6.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd7.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd8.png)
--
![:img 75%, 12.5%, 20%](../Figs/network_pers/network_pd9.png)

---
# Network Distance Metrics

![:img 95%, 2.5%, 20%](../Figs/network_pers/distance_summary.png)

???
Other distance metrics can also be used as shown here. These examples show that the distance matrices and corresponding persistence diagrams will be heavily dependent on the metric chosen so it is important to consider multiple notions of distance. 


---

# Sine Wave Example

![:img 70%, 15%, 20%](../Figs/cgssn_pd_example.png)

???
Here is an example of the full pipeline applied to the sine wave. The CGSSN and distance matrix are obtained to get the resulting persistence diagram.

There is a single prominent loop in the persistence diagram which indicates that the signal is periodic. 


---
# Empirical Testing of 23 Dynamical Systems

![:img 80%, 10%, 70%](../Figs/cgssn_testing/procedure_1.png)

.footnote[Myers, A. D., **Chumley, M. M.**, Khasawneh, F. A., &amp; Munch, E. (2023). "Persistent homology of coarse-grained state-space networks." Physical Review E, 107(3), 034303. ]

???
I tested this approach on 23 continuous dynamical systems using a machine learning pipeline. 

The systems were simulated using both periodic and chaotic parameters and the pairwise bottleneck distance was computed to give a dissimilarity measure between persistence diagrams.

A new distance matrix was then obtained with these bottleneck distances and multidimensional scaling was used to reduce the dimensionality to two. 

I then generate a decision boundary in this 2D space using support vector machine with a radial basis function kernel to form a separation between periodic and chaotic signals. 

Each system is then plotted as a point in this 2D space with the corresponding label to measure the accuracy of the classification.

Using the diffusion distance on ordinal partition networks I get the classification result shown here with 95% accuracy. When I apply the CGSSN to the same systems I get 100% separation accuracy. 

--
![:img 80%, 10%, 70%](../Figs/cgssn_testing/procedure_2.png)
--
![:img 80%, 10%, 70%](../Figs/cgssn_testing/procedure_3.png)
--
![:img 80%, 10%, 70%](../Figs/cgssn_testing/procedure_4.png)

--
![:img 52%, 24%, 20%](../Figs/cgssn_testing/mds_1.png)

--
![:img 52%, 24%, 20%](../Figs/cgssn_testing/mds_2.png)


---
count: true
# Experimental Results - Periodic

![:img 25%, 10%, 20%](../Figs/periodic_vid.gif)

![:img 30%, 5%, 70%](../Figs/periodic_ts.png)
![:img 60%, 37%, 25%](../Figs/magnetic_pendulum_periodic.png)

.footnote[Myers, A. D., **Chumley, M. M.**, Khasawneh, F. A., &amp; Munch, E. (2023). "Persistent homology of coarse-grained state-space networks." Physical Review E, 107(3), 034303. ]

???
I also generated CGSSN results using experimental data from a magnetic pendulum. In the periodic case we see the resulting network gives a single loop and the persistence diagrams reflect the large loop. 

---
count: false
# Experimental Results - Chaotic

![:img 25%, 10%, 20%](../Figs/chaotic_vid.gif) 

![:img 30%, 5%, 70%](../Figs/chaotic_ts.png)
![:img 60%, 37%, 25%](../Figs/magnetic_pendulum_chaotic.png)

.footnote[Myers, A. D., **Chumley, M. M.**, Khasawneh, F. A., &amp; Munch, E. (2023). "Persistent homology of coarse-grained state-space networks." Physical Review E, 107(3), 034303. ]

???
For the chaotic dynamics, the network is much more tangled and the persistence diagrams contain many loops indicating that the signal is chaotic.



---
# Thank you! 

&lt;!-- ![:img 75%, 12.5%, 16%](../Figs/contact_info.png) --&gt;
![:img 90%, 5%, 30%](../Figs/cg_pipeline/pipeline5.png)

.footnote[
&lt;p style="font-size: 15px;"&gt;Myers, A. D., &lt;b&gt;Chumley, M. M.&lt;/b&gt;, Khasawneh, F. A., &amp; Munch, E. (2023). &lt;b&gt;"Persistent homology of coarse-grained state-space networks."&lt;/b&gt; Physical Review E, 107(3), 034303.&lt;/p&gt;

]


???
Thank you for your attention. My paper on this work is cited at the bottom of this slide.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="../../js/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
